
RELEASE=7

echo "Setting RELEASE=$RELEASE"

DistType "redhat"
MirrorURL "http://mirror.centos.org/centos-${RELEASE}/${RELEASE}/os/\$basearch/"

Setup
Bootstrap

InstallPkgs yum cmake git epel-release wget tcsh xauth xclock mlocate time tree
InstallPkgs numpy numpy-f2py scipy tar gzip
InstallPkgs gcc gcc-gfortran gcc-c++ python python-devel python-virtualenv atlas atlas-devel lapack lapack-devel lapack64 lapack64-develzlib zlib-devel libtiff libtiff-devel libjpeg-turbo libjpeg-turbo-devel hdf5 hdf5-devel fftw fftw-devel libpng libpng-devel libpng-static
InstallPkgs xorg-x11-fonts-* mesa-* python-pip python-wheel python-pillow python-pillow-devel R readline readline-devel python-singledispatch

InstallFile runscript.sh /singularity
InstallFile pysegtools-0.1.tar.gz /
RunCmd "cd /; tar -zxf pysegtools-0.1.tar.gz"

RunCmd "updatedb"
RunCmd "pip install wheel"
RunCmd "pip install numpy"
RunCmd "pip install cython"
RunCmd "pip install scipy --upgrade"
RunCmd "pip install pillow --upgrade"
RunCmd "pip install psutil"
RunCmd "pip install subprocess32"
RunCmd "pip install h5py"
RunCmd "pip install pyfftw"
RunCmd "pip install rpy2"


# Make directories used on Gordon, Comet, & Rocce
RunCmd "mkdir /oasis"
RunCmd "mkdir /projects"
RunCmd "mkdir /data"

RunCmd "cd /pysegtools-0.1;python setup.py install"

Cleanup

